\documentclass[11pt,a4paper,twoside]{book}

% ===== PACKAGES =====
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{microtype}
\usepackage{amsmath,amssymb,amsthm}
\usepackage{graphicx}
\usepackage{xcolor}
\usepackage{tikz}
\usepackage{listings}
\usepackage{hyperref}
\usepackage{booktabs}
\usepackage{enumitem}
\usepackage{fancyhdr}
\usepackage{titlesec}
\usepackage{tcolorbox}
\usepackage{fontawesome5}
\usepackage{mdframed}

% ===== GEOMETRY - SMALLER MARGINS =====
\usepackage[
    top=2cm,
    bottom=2cm,
    left=2.5cm,
    right=2cm,
    marginparwidth=1.8cm,
    marginparsep=0.3cm,
    headheight=14pt,
    headsep=1cm,
    footskip=1cm
]{geometry}

% ===== COLORS =====
\definecolor{noteblue}{RGB}{13, 110, 253}
\definecolor{tipgreen}{RGB}{25, 135, 84}
\definecolor{importantorange}{RGB}{255, 149, 0}
\definecolor{warningyellow}{RGB}{255, 193, 7}
\definecolor{cautionred}{RGB}{220, 53, 69}
\definecolor{codegray}{RGB}{248, 249, 250}
\definecolor{linkblue}{RGB}{0, 123, 255}

% ===== HYPERREF SETUP =====
\hypersetup{
    colorlinks=true,
    linkcolor=linkblue,
    citecolor=linkblue,
    urlcolor=linkblue,
    bookmarksdepth=3,
    pdfborder={0 0 0}
}

% ===== GITHUB-STYLE CALLOUT BOXES =====
\tcbuselibrary{skins,breakable}

% Base style for all callouts - GitHub-like design
\tcbset{
    calloutbase/.style={
        enhanced,
        breakable,
        sharp corners,
        colback=white,
        colframe=#1,
        borderline west={3pt}{0pt}{#1},
        boxrule=1pt,
        left=12pt,
        right=8pt,
        top=8pt,
        bottom=8pt,
        fonttitle=\bfseries\sffamily\small,
        coltitle=#1,
        title style={left color=#1!10, right color=#1!5},
        before skip=1.5\baselineskip,
        after skip=1.5\baselineskip,
    }
}

% NOTE callout - Blue theme
\newtcolorbox{noteblock}{
    calloutbase=noteblue,
    colback=noteblue!3,
    title={\textcolor{noteblue}{\faInfoCircle}\ \textcolor{noteblue}{NOTE}}
}

% TIP callout - Green theme  
\newtcolorbox{tipblock}{
    calloutbase=tipgreen,
    colback=tipgreen!3,
    title={\textcolor{tipgreen}{\faLightbulb}\ \textcolor{tipgreen}{TIP}}
}

% IMPORTANT callout - Orange theme
\newtcolorbox{importantblock}{
    calloutbase=importantorange,
    colback=importantorange!3,
    title={\textcolor{importantorange}{\faExclamationCircle}\ \textcolor{importantorange}{IMPORTANT}}
}

% WARNING callout - Yellow theme
\newtcolorbox{warningblock}{
    calloutbase=warningyellow,
    colback=warningyellow!3,
    title={\textcolor{warningyellow!80!black}{\faExclamationTriangle}\ \textcolor{warningyellow!80!black}{WARNING}}
}

% CAUTION callout - Red theme
\newtcolorbox{cautionblock}{
    calloutbase=cautionred,
    colback=cautionred!3,
    title={\textcolor{cautionred}{\faExclamationTriangle}\ \textcolor{cautionred}{CAUTION}}
}
% ===== CODE LISTINGS - C LANGUAGE =====
\lstset{
    backgroundcolor=\color{codegray},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,
    breaklines=true,
    captionpos=b,
    commentstyle=\color{gray},
    frame=single,
    frameround=tttt,
    framesep=5pt,
    keywordstyle=\color{blue},
    language=C,
    numbers=left,
    numbersep=5pt,
    numberstyle=\tiny\color{gray},
    rulecolor=\color{black},
    showspaces=false,
    showstringspaces=false,
    showtabs=false,
    stringstyle=\color{red},
    tabsize=4,
    morekeywords={size_t, ssize_t, socklen_t, struct, typedef}
}

% ===== CHAPTER AND SECTION FORMATTING =====
\titleformat{\chapter}[display]
  {\normalfont\huge\bfseries\sffamily}
  {\chaptertitlename\ \thechapter}
  {20pt}
  {\Huge}
  
\titleformat{\section}
  {\normalfont\Large\bfseries\sffamily}
  {\thesection}
  {1em}
  {}
  
\titleformat{\subsection}
  {\normalfont\large\bfseries\sffamily}
  {\thesubsection}
  {1em}
  {}

% ===== HEADER AND FOOTER =====
\pagestyle{fancy}
\fancyhf{}
\fancyhead[LE]{\nouppercase{\leftmark}}
\fancyhead[RO]{\nouppercase{\rightmark}}
\fancyfoot[LE,RO]{\thepage}
\renewcommand{\headrulewidth}{0.4pt}
\renewcommand{\footrulewidth}{0pt}

% ===== THEOREM ENVIRONMENTS =====
\theoremstyle{definition}
\newtheorem{definition}{Definition}[chapter]
\newtheorem{example}{Example}[chapter]
\newtheorem{protocol}{Protocol}[chapter]

\theoremstyle{plain}
\newtheorem{theorem}{Theorem}[chapter]
\newtheorem{lemma}{Lemma}[chapter]

% ===== DOCUMENT METADATA =====
\title{Computer Networks: Course Reader}
\author{Computer Networks TAs et al.}
\date{Latest revision: \today}


% ===== OTHER =====
\setlength{\parindent}{0pt}
\setlength{\parskip}{0.5\baselineskip}
\setcounter{tocdepth}{1}
% link color dark blue
\hypersetup{
    linkcolor=blue,
    citecolor=blue,
    urlcolor=blue
}


\begin{document}

% ===== TITLE PAGE =====
\frontmatter
\maketitle

% ===== TABLE OF CONTENTS =====
\tableofcontents
% \listoffigures
% \listoftables

% ===== MAIN CONTENT =====
\mainmatter
\input{sections/0_preface}
\input{sections/1_networking}
\input{sections/2_osi}
% ===== APPENDICES =====
\appendix

\input{contributors.tex}

% ===== BACK MATTER =====
\backmatter


\section*{Contributions}
\label{sec:contributions}
\input{sections/pull_requests}
\end{document}